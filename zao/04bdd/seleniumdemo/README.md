This example was initially created by Jakub Neumann, and modified during lecture (most of the code is new)